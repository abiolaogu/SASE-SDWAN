# OpenSASE VPP Engine - OpenSASE Plugin Configuration
#
# This file is executed by VPP after startup.
# Configure interfaces, policies, and tunnels here.
#
# File: /etc/vpp/opensase.conf

# ===============================
# Interface Configuration
# ===============================

# Enable WAN interface
set interface state wan0 up
set interface mtu 9000 wan0

# Enable LAN interface  
set interface state lan0 up
set interface mtu 9000 lan0

# Create loopback for management
create loopback interface
set interface state loop0 up
set interface ip address loop0 10.255.255.1/32

# ===============================
# OpenSASE Feature Activation
# ===============================

# Enable OpenSASE processing on WAN interface
# This inserts the SASE pipeline into the IPv4 path
set interface feature wan0 ip4-unicast opensase-tenant

# Enable on LAN interface for return traffic
set interface feature lan0 ip4-unicast opensase-tenant

# ===============================
# Tenant Configuration
# ===============================

# Example: Add tenant mappings
# opensase tenant add 10.0.0.0/8 tenant 1 vrf 100
# opensase tenant add 172.16.0.0/12 tenant 2 vrf 200
# opensase tenant add 192.168.0.0/16 tenant 3 vrf 300

# ===============================
# NAT Pool Configuration
# ===============================

# Example: Configure NAT pools per tenant
# opensase nat pool tenant 1 address 203.0.113.1 ports 10000-30000
# opensase nat pool tenant 2 address 203.0.113.2 ports 10000-30000
# opensase nat pool tenant 3 address 203.0.113.3 ports 10000-30000

# ===============================
# Tunnel Configuration
# ===============================

# Example: Create WireGuard tunnel to PoP
# opensase tunnel create local 203.0.113.1 remote 198.51.100.1 wireguard interface wan0

# ===============================
# QoS Rate Limits
# ===============================

# Example: Set rate limits per tenant
# opensase qos rate-limit tenant 1 class 4 rate 1000
# opensase qos rate-limit tenant 2 class 4 rate 500

# ===============================
# Policy Configuration
# ===============================

# Policies are typically loaded via API from management plane
# Example CLI policy:
# opensase policy add src 10.0.0.0/8 dst any action allow
# opensase policy add src any dst 10.0.0.0/8 action inspect-dlp

# ===============================
# Display Configuration
# ===============================

show interface
show opensase version
show opensase stats
