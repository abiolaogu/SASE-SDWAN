################################################################################
# OpenSASE Peering Engine - DE-CIX Frankfurt Configuration
# /etc/bird/ixp/decix-fra.conf
################################################################################

# DE-CIX Local Address
define DECIX_LOCAL_IP4 = 80.81.192.XXX;      # Replace with actual IP
define DECIX_LOCAL_IP6 = 2001:7f8::XXXX:0:1; # Replace with actual IP

#===============================================================================
# Route Server Sessions
#===============================================================================

protocol bgp decix_rs1 from tpl_ixp_rs {
    neighbor 80.81.192.157 as 6695;
    source address DECIX_LOCAL_IP4;
    description "DE-CIX Frankfurt RS1";
    
    ipv4 {
        import limit 200000 action restart;
    };
}

protocol bgp decix_rs2 from tpl_ixp_rs {
    neighbor 80.81.192.158 as 6695;
    source address DECIX_LOCAL_IP4;
    description "DE-CIX Frankfurt RS2";
}

# IPv6 Route Servers
protocol bgp decix_rs1_v6 {
    local as MY_ASN;
    neighbor 2001:7f8::6e28:0:1 as 6695;
    source address DECIX_LOCAL_IP6;
    description "DE-CIX Frankfurt RS1 IPv6";
    graceful restart on;
    
    ipv6 {
        import filter import_from_peers;
        export filter export_to_peers;
        import limit 100000 action restart;
    };
}

#===============================================================================
# Priority Bilateral Peers at DE-CIX
#===============================================================================

# Cloudflare (AS13335) - Major CDN
protocol bgp decix_cloudflare from tpl_bilateral {
    neighbor 80.81.193.13 as 13335;
    source address DECIX_LOCAL_IP4;
    description "Cloudflare @ DE-CIX";
    
    ipv4 {
        import limit 20000 action restart;
    };
}

# Google (AS15169) - Content
protocol bgp decix_google from tpl_bilateral {
    neighbor 80.81.193.15 as 15169;
    source address DECIX_LOCAL_IP4;
    description "Google @ DE-CIX";
    
    ipv4 {
        import limit 50000 action restart;
    };
}

# Facebook/Meta (AS32934)
protocol bgp decix_facebook from tpl_bilateral {
    neighbor 80.81.193.32 as 32934;
    source address DECIX_LOCAL_IP4;
    description "Facebook @ DE-CIX";
    
    ipv4 {
        import limit 10000 action restart;
    };
}

# Amazon AWS (AS16509)
protocol bgp decix_amazon from tpl_bilateral {
    neighbor 80.81.193.16 as 16509;
    source address DECIX_LOCAL_IP4;
    description "Amazon @ DE-CIX";
    
    ipv4 {
        import limit 20000 action restart;
    };
}

# Microsoft (AS8075)
protocol bgp decix_microsoft from tpl_bilateral {
    neighbor 80.81.193.8 as 8075;
    source address DECIX_LOCAL_IP4;
    description "Microsoft @ DE-CIX";
    
    ipv4 {
        import limit 20000 action restart;
    };
}

# Akamai (AS20940)
protocol bgp decix_akamai from tpl_bilateral {
    neighbor 80.81.193.20 as 20940;
    source address DECIX_LOCAL_IP4;
    description "Akamai @ DE-CIX";
    
    ipv4 {
        import limit 5000 action restart;
    };
}

# Hurricane Electric (AS6939) - Transit/IX
protocol bgp decix_he from tpl_bilateral {
    neighbor 80.81.192.6 as 6939;
    source address DECIX_LOCAL_IP4;
    description "Hurricane Electric @ DE-CIX";
    
    ipv4 {
        import limit 150000 action restart;  # HE has lots of routes
    };
}

# Deutsche Telekom (AS3320) - Major German ISP
protocol bgp decix_dtag from tpl_bilateral {
    neighbor 80.81.192.33 as 3320;
    source address DECIX_LOCAL_IP4;
    description "Deutsche Telekom @ DE-CIX";
    
    ipv4 {
        import limit 30000 action restart;
    };
}

#===============================================================================
# Regional ISPs at DE-CIX
#===============================================================================

# Vodafone Germany (AS3209)
# protocol bgp decix_vodafone from tpl_bilateral {
#     neighbor 80.81.193.XXX as 3209;
#     source address DECIX_LOCAL_IP4;
#     description "Vodafone Germany @ DE-CIX";
# }

# Telefonica Germany (AS6805)
# protocol bgp decix_telefonica from tpl_bilateral {
#     neighbor 80.81.193.XXX as 6805;
#     source address DECIX_LOCAL_IP4;
#     description "Telefonica @ DE-CIX";
# }
